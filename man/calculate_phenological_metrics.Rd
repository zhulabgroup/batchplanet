% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/calculate_phenological_metrics.R
\name{calculate_phenological_metrics}
\alias{calculate_phenological_metrics}
\title{Calculate phenological metrics for a single time series}
\usage{
calculate_phenological_metrics(
  df_index,
  df_thres,
  min_days,
  check_seasonality = T,
  var_index = "evi"
)
}
\arguments{
\item{df_index}{Data frame of remote sensing index time series at one location in one year. Must contain columns \code{doy} and the index of interest.}

\item{df_thres}{Data frame containing candidate threshold values, with columns \code{direction} ("up"/"down") and \code{threshold} (numeric 0â€“1).}

\item{min_days}{Numeric. Minimum required number of non-NA data points in one year (default: 80).}

\item{check_seasonality}{Logical. If \code{TRUE}, tests for significant seasonal changes before calculating phenological metrics (default: \code{TRUE}).}

\item{var_index}{Character. Name of the index column in \code{df_index} to analyze (default: "evi").}
}
\value{
A data frame of phenological metrics (DOY) per threshold and direction, or \code{NULL} if there are fewer than \code{min_days} valid data points or if the index does not show a seasonal pattern.
}
\description{
Processes a remote sensing index time series for a single location in one year by gap-filling and smoothing (using Whittaker smoothing), testing for seasonality, and calculating day-of-year (DOY) when the index crosses green-up or green-down threshold(s) specified in \code{df_thres}.
The input time series should ideally be extended to include the end of the previous year and the beginning of the next year to capture early- and late-year events.
}
\examples{
\dontrun{
# Example: Calculate DOY metrics for a single cleaned time series
df_thres <- set_thresholds(thres_up = c(0.3, 0.5), thres_down = NULL)
df_metrics <- calculate_phenological_metrics(
  df_index = df_clean,
  df_thres = df_thres,
  min_days = 80,
  check_seasonality = TRUE,
  var_index = "evi"
)
}

}
